---
title: 用svg.JS搞完时间轴了，感觉很难受。。需要重构
date: 2018-06-06 14:57:56
tags:
---

### 黑暗的两周

之前两周都在搞可以拖动的时间轴，谁知道那边是什么情况，明明之前说的那个时间轴就ok，结果最后还需要可拖动的，还根据时间自动确定有多长的。很是蛋疼，但是最后还是做完了。明显整个过程是有问题的，需求压不住，最后改需求。我的话，直接把对面一个人拉进来，每次都把细节和对面讨论一下，事无巨细，让对方也感受一下工作量。

当然，改完了，就是好事儿，收尾晚点处理。

### 重构

这个鬼玩意在写的过程中，遇到的坑太多了。

1. drag插件调用时机很迷。每次我鼠标按下，都会触发drag插件的调用，这个坑至少坑了我3天。

2. 防抖的处理。可以说防抖的处理非常的迷，不过大概率是因为drag插件触发机制的原因。

3. 本打算引入mobx来处理一下状态，但是老大一说，直接用react-redux（当然是老大定制版）给传入所需状态就行了。倒是没问题，但是这么做，活是不是太糙了？

4. 还是状态管理的事，不过是组件实例的问题，因为各个组件中都可能会引用到某个实例，所以可以搞一个组件池（想不出别的名字了）?然后每次创建，往组件池里，放入对应组件。组件池弄多大是问题，要不要用到context？用到的话就比较麻烦了（得看看redux怎么处理的，不过目测，搞明白react-redux就可以了）

5. 还是状态管理的事！当然，是最后的事儿了。可以在内部，放一个this.pool，直接放入其中就可以。然后记得瞎胡传this.pool就行。

6. 最最后了！还是先用mobx先实现一个干净版本的好了。

7. 去tm的，用context就可以舒爽解决了。

### npm源的指向
```javascript
npm config set registry https://registry.npm.taobao.org //指向淘宝的源
npm --registry https://registry.npm.taobao.org install express // 临时
npm config set registry https://registry.npmjs.org/ //指向npm官网的源
```